(()=>{var t={195:(t,o,e)=>{t.exports=e(407)},407:t=>{var o=function(t){"use strict";var o,e=Object.prototype,r=e.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},s=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",i=n.toStringTag||"@@toStringTag";function l(t,o,e){return Object.defineProperty(t,o,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[o]}try{l({},"")}catch(t){l=function(t,o,e){return t[o]=e}}function u(t,o,e,r){var n=o&&o.prototype instanceof w?o:w,s=Object.create(n.prototype),a=new P(r||[]);return s._invoke=function(t,o,e){var r=f;return function(n,s){if(r===p)throw new Error("Generator is already running");if(r===h){if("throw"===n)throw s;return S()}for(e.method=n,e.arg=s;;){var a=e.delegate;if(a){var i=U(a,e);if(i){if(i===d)continue;return i}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if(r===f)throw r=h,e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);r=p;var l=c(t,o,e);if("normal"===l.type){if(r=e.done?h:m,l.arg===d)continue;return{value:l.arg,done:e.done}}"throw"===l.type&&(r=h,e.method="throw",e.arg=l.arg)}}}(t,e,a),s}function c(t,o,e){try{return{type:"normal",arg:t.call(o,e)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var f="suspendedStart",m="suspendedYield",p="executing",h="completed",d={};function w(){}function v(){}function y(){}var g={};g[s]=function(){return this};var b=Object.getPrototypeOf,_=b&&b(b(O([])));_&&_!==e&&r.call(_,s)&&(g=_);var x=y.prototype=w.prototype=Object.create(g);function L(t){["next","throw","return"].forEach((function(o){l(t,o,(function(t){return this._invoke(o,t)}))}))}function F(t,o){function e(n,s,a,i){var l=c(t[n],t,s);if("throw"!==l.type){var u=l.arg,f=u.value;return f&&"object"==typeof f&&r.call(f,"__await")?o.resolve(f.__await).then((function(t){e("next",t,a,i)}),(function(t){e("throw",t,a,i)})):o.resolve(f).then((function(t){u.value=t,a(u)}),(function(t){return e("throw",t,a,i)}))}i(l.arg)}var n;this._invoke=function(t,r){function s(){return new o((function(o,n){e(t,r,o,n)}))}return n=n?n.then(s,s):s()}}function U(t,e){var r=t.iterator[e.method];if(r===o){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=o,U(t,e),"throw"===e.method))return d;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var n=c(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,d;var s=n.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=o),e.delegate=null,d):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function k(t){var o={tryLoc:t[0]};1 in t&&(o.catchLoc=t[1]),2 in t&&(o.finallyLoc=t[2],o.afterLoc=t[3]),this.tryEntries.push(o)}function N(t){var o=t.completion||{};o.type="normal",delete o.arg,t.completion=o}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function O(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,a=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=o,e.done=!0,e};return a.next=a}}return{next:S}}function S(){return{value:o,done:!0}}return v.prototype=x.constructor=y,y.constructor=v,v.displayName=l(y,i,"GeneratorFunction"),t.isGeneratorFunction=function(t){var o="function"==typeof t&&t.constructor;return!!o&&(o===v||"GeneratorFunction"===(o.displayName||o.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,l(t,i,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},L(F.prototype),F.prototype[a]=function(){return this},t.AsyncIterator=F,t.async=function(o,e,r,n,s){void 0===s&&(s=Promise);var a=new F(u(o,e,r,n),s);return t.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(x),l(x,i,"Generator"),x[s]=function(){return this},x.toString=function(){return"[object Generator]"},t.keys=function(t){var o=[];for(var e in t)o.push(e);return o.reverse(),function e(){for(;o.length;){var r=o.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=O,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(N),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=o)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=o),!!n}for(var s=this.tryEntries.length-1;s>=0;--s){var a=this.tryEntries[s],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,o){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var s=n;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=o&&o<=s.finallyLoc&&(s=null);var a=s?s.completion:{};return a.type=t,a.arg=o,s?(this.method="next",this.next=s.finallyLoc,d):this.complete(a)},complete:function(t,o){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&o&&(this.next=o),d},finish:function(t){for(var o=this.tryEntries.length-1;o>=0;--o){var e=this.tryEntries[o];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),N(e),d}},catch:function(t){for(var o=this.tryEntries.length-1;o>=0;--o){var e=this.tryEntries[o];if(e.tryLoc===t){var r=e.completion;if("throw"===r.type){var n=r.arg;N(e)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:O(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=o),d}},t}(t.exports);try{regeneratorRuntime=o}catch(t){Function("r","regeneratorRuntime = r")(o)}}},o={};function e(r){var n=o[r];if(void 0!==n)return n.exports;var s=o[r]={exports:{}};return t[r](s,s.exports,e),s.exports}e.n=t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return e.d(o,{a:o}),o},e.d=(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},e.o=(t,o)=>Object.prototype.hasOwnProperty.call(t,o),e.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};(()=>{"use strict";e.r(r);const t=flarum.core.compat["forum/app"];var o=e.n(t);const n=flarum.core.compat["common/extend"],s=flarum.core.compat["forum/components/NotificationGrid"];var a=e.n(s);const i=flarum.core.compat["common/Model"];var l=e.n(i);const u=flarum.core.compat["common/models/User"];var c=e.n(u);const f=flarum.core.compat["forum/utils/UserControls"];var p=e.n(f);const h=flarum.core.compat["common/components/Button"];var d=e.n(h);function w(t,o,e,r,n,s,a){try{var i=t[s](a),l=i.value}catch(t){return void e(t)}i.done?o(l):Promise.resolve(l).then(r,n)}function v(){return v=Object.assign||function(t){for(var o=1;o<arguments.length;o++){var e=arguments[o];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},v.apply(this,arguments)}function y(t,o){return y=Object.setPrototypeOf||function(t,o){return t.__proto__=o,t},y(t,o)}function g(t,o){t.prototype=Object.create(o.prototype),t.prototype.constructor=t,y(t,o)}var b=e(195),_=e.n(b);const x=flarum.core.compat["common/components/Modal"];var L=e.n(x);const F=flarum.core.compat["common/components/Select"];var U=e.n(F);const k=flarum.core.compat["common/app"];var N=e.n(k),P=function(t){return function(o){return N().translator.trans("ianm-follow-users.lib.follow_levels."+t,o)}},O=Object.freeze([{value:"unfollow",name:P("unfollow.name"),description:P("unfollow.description")},{value:"follow",name:P("follow.name"),description:P("follow.description")},{value:"lurk",name:P("lurk.name"),description:P("lurk.description")}]),S=function(t){function e(){for(var o,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(o=t.call.apply(t,[this].concat(r))||this).state={user:null,saving:!1,followState:void 0},o.className=function(){return"iam_follow_users-selectFollowLevelModal"},o}g(e,t);var r=e.prototype;return r.oninit=function(o){t.prototype.oninit.call(this,o),this.state.user=this.attrs.user,this.state.followState=this.state.user.followed()||"unfollow"},r.title=function(){var t;return this.trans("title",{username:m("em",null,null==(t=this.state.user)||null==t.username?void 0:t.username())})},r.content=function(){var t=this;if(!(this.state.user instanceof c()))return m("div",{class:"Modal-body"},m("p",null,this.trans("no_user_attr_provided_err"+(o().forum.attribute("debug")?"_debug":""))));var e=this.state.user,r=O.reduce((function(t,o){var e;return v({},t,((e={})[o.value]=o.name(),e))}),{}),n=O.find((function(o){return o.value===t.state.followState}));return m("div",{class:"Modal-body"},m("fieldset",null,m("legend",null,this.trans("description",{user:e})),m("div",{class:"selectFollowLevelModal-level"},m("label",{for:"selectFollowLevelModal-select"},this.trans("follow_select_label")),m(U(),{disabled:this.state.saving,id:"selectFollowLevelModal-select",onchange:this.onFollowLevelChange.bind(this),value:n.value,"aria-described-by":"selectFollowLevelModal-"+n.value+"-help",options:r}),m("p",{id:"selectFollowLevelModal-"+n.value+"-help"},n.description({user:e})))),m("fieldset",{class:"selectFollowLevelModal-actions"},m(d(),{disabled:this.state.saving,class:"Button",onclick:this.hide.bind(this)},this.trans("cancel_btn")),m(d(),{disabled:this.state.saving,class:"Button Button--primary",onclick:this.saveFollowLevel.bind(this),loading:this.state.saving},this.trans("save_btn"))))},r.onFollowLevelChange=function(){var t=this.$(".Select-input")[0];this.state.followState=t.value||"unfollow"},r.trans=function(t){for(var e,r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];return(e=o().translator).trans.apply(e,["ianm-follow-users.forum.modals.select_follow_level."+t].concat(n))},r.onsubmit=function(){this.saveFollowLevel()},r.saveFollowLevel=function(){var t,o=(t=_().mark((function t(){var o;return _().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o="unfollow"===this.state.followState?null:this.state.followState,this.state.saving=!0,this.state.user.attribute("following")!==o){t.next=5;break}return this.hide(),t.abrupt("return");case 5:return t.next=7,this.state.user.save({followUsers:o});case 7:t.sent,this.hide();case 9:case"end":return t.stop()}}),t,this)})),function(){var o=this,e=arguments;return new Promise((function(r,n){var s=t.apply(o,e);function a(t){w(s,r,n,a,i,"next",t)}function i(t){w(s,r,n,a,i,"throw",t)}a(void 0)}))});return function(){return o.apply(this,arguments)}}(),e}(L());const j=flarum.core.compat["forum/components/UserCard"];var B=e.n(j);const E=flarum.core.compat["common/components/Link"];var C=e.n(E);const G=flarum.core.compat["forum/components/AvatarEditor"];var M=e.n(G);const T=flarum.core.compat["common/helpers/username"];var A=e.n(T);const D=flarum.core.compat["common/helpers/avatar"];var I=e.n(D);const z=flarum.core.compat["common/helpers/listItems"];var R=e.n(z);const Y=flarum.core.compat["common/components/Dropdown"];var q=e.n(Y);const $=flarum.core.compat["common/components/LinkButton"];var H=e.n($);const J=flarum.core.compat["forum/components/UserPage"];var K=e.n(J),Q=function(t){function e(){return t.apply(this,arguments)||this}g(e,t);var r=e.prototype;return r.oninit=function(o){t.prototype.oninit.call(this,o),this.refresh()},r.refresh=function(){this.loading=!0,this.followedUsers=o().session.user.followedUsers(),this.loadUser(o().session.user.username())},r.changeUserFollowOptions=function(t){o().modal.show(S,{user:t})},r.content=function(){var t=this;return 0===this.followedUsers.length?m("div",{class:"Placeholder"},m("p",null,o().translator.trans("ianm-follow-users.forum.profile_page.no_following"))):m("table",{className:"NotificationGrid followPage-grid"},this.followedUsers.map((function(e,r){return m("tr",{class:"followPage-user"},m("td",null,m(C(),{href:o().route.user(e)},m("h3",null,I()(e,{className:"followPage-avatar"}),m("div",{class:"followPage-userInfo"},A()(e),m("span",{class:"followPage-type"},o().translator.trans("ianm-follow-users.forum.badge.label."+e.followed())))))),m("td",{className:"followPage-button"},m(d(),{icon:"fas fa-user-friends",type:"button",className:"Button Button--warning",onclick:function(){return t.changeUserFollowOptions(e)}},o().translator.trans("ianm-follow-users.forum.user_controls.unfollow_button"))))})))},r.show=function(){this.user=o().session.user,m.redraw()},e}(K());const V=flarum.core.compat["common/components/Notification"];var W=e.n(V),X=function(t){function e(){return t.apply(this,arguments)||this}g(e,t);var r=e.prototype;return r.icon=function(){return"fas fa-user-friends"},r.href=function(){var t=this.attrs.notification.subject();return o().route.discussion(t)},r.content=function(){return o().translator.trans("ianm-follow-users.forum.notifications.new_discussion_text",{user:this.attrs.notification.fromUser(),title:this.attrs.notification.subject().title()})},r.excerpt=function(){return null},e}(W()),Z=function(t){function e(){return t.apply(this,arguments)||this}g(e,t);var r=e.prototype;return r.icon=function(){return"fas fa-user-friends"},r.href=function(){var t=this.attrs.notification,e=t.subject(),r=t.content()||{};return o().route.discussion(e,r.postNumber)},r.content=function(){return o().translator.trans("ianm-follow-users.forum.notifications.new_post_text",{user:this.attrs.notification.fromUser()})},r.excerpt=function(){return null},e}(W()),tt=function(t){function e(){return t.apply(this,arguments)||this}g(e,t);var r=e.prototype;return r.icon=function(){return"fas fa-user-plus"},r.href=function(){var t=this.attrs.notification.subject();return o().route.user(t)},r.content=function(){return o().translator.trans("ianm-follow-users.forum.notifications.new_follower_text",{user:this.attrs.notification.fromUser()})},r.excerpt=function(){return null},e}(W()),ot=function(t){function e(){return t.apply(this,arguments)||this}g(e,t);var r=e.prototype;return r.icon=function(){return"fas fa-user-minus"},r.href=function(){var t=this.attrs.notification.subject();return o().route.user(t)},r.content=function(){return o().translator.trans("ianm-follow-users.forum.notifications.new_unfollower_text",{user:this.attrs.notification.fromUser()})},r.excerpt=function(){return null},e}(W());const et=flarum.core.compat["common/models/Discussion"];var rt=e.n(et);const nt=flarum.core.compat["common/components/Badge"];var st=e.n(nt);const at=flarum.core.compat["forum/components/SettingsPage"];var it=e.n(at);const lt=flarum.core.compat["common/components/Switch"];var ut=e.n(lt);const ct=flarum.extensions["fof-follow-tags"],ft=flarum.extensions["fof-user-directory"],mt=flarum.core.compat["forum/states/DiscussionListState"];var pt=e.n(mt),ht=ct.utils.followingPageOptions;const dt=function(t){var o=ht(t);return o.users=N().translator.trans("ianm-follow-users.lib.following_link"),o},wt=flarum.core.compat["common/components/Separator"];var vt=e.n(wt);o().initializers.add("ianm-follow-users",(function(){c().prototype.followed=l().attribute("followed"),c().prototype.followedUsers=l().hasMany("followedUsers"),c().prototype.blocksFollow=l().attribute("blocksFollow"),c().prototype.canBeFollowed=l().attribute("canBeFollowed"),o().routes.followedUsers={path:"/followedUsers",component:Q},(0,n.extend)(p(),"userControls",(function(t,e){o().session.user&&o().session.user!==e&&e.canBeFollowed()&&t.add("follow",m(d(),{icon:"fas fa-user-friends",onclick:function(t){t instanceof c()&&o().modal.show(S,{user:t})}.bind(this,e)},o().translator.trans("ianm-follow-users.forum.user_controls."+(e.followed()?"unfollow_button":"follow_button"))))})),(0,n.override)(B().prototype,"view",(function(t){if(!o().forum.attribute("ianm-follow-users.button-on-profile"))return t();var e=this.attrs.user,r=p().controls(e,this).toArray(),n=e.color(),s=e.badges().toArray();return m("div",{className:"UserCard "+(this.attrs.className||""),style:n&&{"--usercard-bg":n}},m("div",{className:"darkenBackground"},m("div",{className:"container"},r.length?q().component({className:"UserCard-controls App-primaryControl",menuClassName:"Dropdown-menu--right",buttonClassName:this.attrs.controlsButtonClassName,label:o().translator.trans("core.forum.user_controls.button"),accessibleToggleLabel:o().translator.trans("core.forum.user_controls.toggle_dropdown_accessible_label"),icon:"fas fa-ellipsis-v"},r):"",m("div",{className:"UserCard-profile"},m("h2",{className:"UserCard-identity"},this.attrs.editable?[M().component({user:e,className:"UserCard-avatar"}),A()(e)]:m(C(),{href:o().route.user(e)},m("div",{className:"UserCard-avatar"},I()(e)),A()(e))),s.length?m("ul",{className:"UserCard-badges badges"},R()(s)):"",e.canBeFollowed()&&m(d(),{className:"Button",icon:"fas fa-user-friends",onclick:function(t){t instanceof c()&&o().modal.show(S,{user:t})}.bind(this,e)},o().translator.trans("ianm-follow-users.forum.user_controls."+(e.followed()?"unfollow_button":"follow_button"))),m("ul",{className:"UserCard-info"},R()(this.infoItems().toArray()))))))})),(0,n.extend)(K().prototype,"navItems",(function(t){o().session.user&&o().session.user===this.user&&t.add("followed-users",m(H(),{href:o().route("followedUsers"),icon:"fas fa-user-friends"},o().translator.trans("ianm-follow-users.forum.profile_link")))})),(0,n.extend)(rt().prototype,"badges",(function(t){var e;null!=(e=this.user())&&null!=e.followed&&e.followed()&&t.add("user-following",m(st(),{label:o().translator.trans("ianm-follow-users.forum.badge.label."+this.user().followed()),icon:"fas fa-user-friends",type:"friend"}))})),(0,n.extend)(c().prototype,"badges",(function(t){this.followed()&&t.add("user-following",m(st(),{label:o().translator.trans("ianm-follow-users.forum.badge.label."+this.followed()),icon:"fas fa-user-friends",type:"friend"}))})),(0,n.extend)(it().prototype,"privacyItems",(function(t){var e=this;t.add("follow-users-block",m(ut(),{state:this.user.preferences().blocksFollow,onchange:function(t){e.blocksFollowLoading=!0,e.user.savePreferences({blocksFollow:t}).then((function(){e.blocksFollowLoading=!1,m.redraw()}))},loading:this.blocksFollowLoading},o().translator.trans("ianm-follow-users.forum.settings.block_follow")))})),app.initializers.has("fof/follow-tags")&&(ct.utils.followingPageOptions=dt,ct.utils.followingPageOptions("forum.index.following"),(0,n.extend)(pt().prototype,"requestParams",(function(t){if(ct.utils.isFollowingPage()&&app.session.user){this.followTags||(this.followTags=ct.utils.getDefaultFollowingFiltering());var o=this.followTags;"following"===app.current.get("routeName")&&"users"===o&&(t.filter["following-users"]=!0,delete t.filter.subscription)}}))),app.initializers.has("fof-user-directory")&&(0,n.extend)(ft.UserDirectoryPage.prototype,"groupItems",(function(t){var o=this;t.add("follow-users",ft.CheckableButton.component({className:"GroupFilterButton",icon:"fas fa-user-friends",checked:"is:followeduser"===this.enabledSpecialGroupFilters["ianm-follow-users"],onclick:function(){var t="ianm-follow-users";"is:followeduser"===o.enabledSpecialGroupFilters[t]?o.enabledSpecialGroupFilters[t]="":o.enabledSpecialGroupFilters[t]="is:followeduser",o.changeParams(o.params().sort)}},app.translator.trans("ianm-follow-users.forum.filter.following")),65),t.add("separator",m(vt(),null),50)})),o().notificationComponents.newFollower=tt,o().notificationComponents.newUnfollower=ot,o().notificationComponents.newDiscussionByUser=X,o().notificationComponents.newPostByUser=Z,(0,n.extend)(a().prototype,"notificationTypes",(function(t){t.add("newFollower",{name:"newFollower",icon:"fas fa-user-plus",label:o().translator.trans("ianm-follow-users.forum.settings.notify_new_follower_label")}),t.add("newUnfollower",{name:"newUnfollower",icon:"fas fa-user-minus",label:o().translator.trans("ianm-follow-users.forum.settings.notify_new_unfollower_label")}),t.add("newDiscussionByUser",{name:"newDiscussionByUser",icon:"fas fa-user-friends",label:o().translator.trans("ianm-follow-users.forum.settings.notify_new_discussion_label")}),t.add("newPostByUser",{name:"newPostByUser",icon:"fas fa-user-friends",label:o().translator.trans("ianm-follow-users.forum.settings.notify_new_post_label")})}))}),-1)})(),module.exports=r})();
//# sourceMappingURL=forum.js.map