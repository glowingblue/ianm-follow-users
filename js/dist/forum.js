(()=>{var t={195:(t,e,o)=>{t.exports=o(236)},236:t=>{var e=function(t){"use strict";var e,o=Object.prototype,r=o.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},s=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",i=n.toStringTag||"@@toStringTag";function l(t,e,o){return Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,o){return t[e]=o}}function u(t,e,o,r){var n=e&&e.prototype instanceof w?e:w,s=Object.create(n.prototype),a=new O(r||[]);return s._invoke=function(t,e,o){var r=f;return function(n,s){if(r===m)throw new Error("Generator is already running");if(r===h){if("throw"===n)throw s;return j()}for(o.method=n,o.arg=s;;){var a=o.delegate;if(a){var i=P(a,o);if(i){if(i===d)continue;return i}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(r===f)throw r=h,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);r=m;var l=c(t,e,o);if("normal"===l.type){if(r=o.done?h:p,l.arg===d)continue;return{value:l.arg,done:o.done}}"throw"===l.type&&(r=h,o.method="throw",o.arg=l.arg)}}}(t,o,a),s}function c(t,e,o){try{return{type:"normal",arg:t.call(e,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var f="suspendedStart",p="suspendedYield",m="executing",h="completed",d={};function w(){}function v(){}function y(){}var g={};g[s]=function(){return this};var b=Object.getPrototypeOf,_=b&&b(b(S([])));_&&_!==o&&r.call(_,s)&&(g=_);var x=y.prototype=w.prototype=Object.create(g);function L(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function F(t,e){function o(n,s,a,i){var l=c(t[n],t,s);if("throw"!==l.type){var u=l.arg,f=u.value;return f&&"object"==typeof f&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,i)}),(function(t){o("throw",t,a,i)})):e.resolve(f).then((function(t){u.value=t,a(u)}),(function(t){return o("throw",t,a,i)}))}i(l.arg)}var n;this._invoke=function(t,r){function s(){return new e((function(e,n){o(t,r,e,n)}))}return n=n?n.then(s,s):s()}}function P(t,o){var r=t.iterator[o.method];if(r===e){if(o.delegate=null,"throw"===o.method){if(t.iterator.return&&(o.method="return",o.arg=e,P(t,o),"throw"===o.method))return d;o.method="throw",o.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var n=c(r,t.iterator,o.arg);if("throw"===n.type)return o.method="throw",o.arg=n.arg,o.delegate=null,d;var s=n.arg;return s?s.done?(o[t.resultName]=s.value,o.next=t.nextLoc,"return"!==o.method&&(o.method="next",o.arg=e),o.delegate=null,d):s:(o.method="throw",o.arg=new TypeError("iterator result is not an object"),o.delegate=null,d)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function U(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function S(t){if(t){var o=t[s];if(o)return o.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,a=function o(){for(;++n<t.length;)if(r.call(t,n))return o.value=t[n],o.done=!1,o;return o.value=e,o.done=!0,o};return a.next=a}}return{next:j}}function j(){return{value:e,done:!0}}return v.prototype=x.constructor=y,y.constructor=v,v.displayName=l(y,i,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,l(t,i,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},L(F.prototype),F.prototype[a]=function(){return this},t.AsyncIterator=F,t.async=function(e,o,r,n,s){void 0===s&&(s=Promise);var a=new F(u(e,o,r,n),s);return t.isGeneratorFunction(o)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(x),l(x,i,"Generator"),x[s]=function(){return this},x.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var o in t)e.push(o);return e.reverse(),function o(){for(;e.length;){var r=e.pop();if(r in t)return o.value=r,o.done=!1,o}return o.done=!0,o}},t.values=S,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(U),!t)for(var o in this)"t"===o.charAt(0)&&r.call(this,o)&&!isNaN(+o.slice(1))&&(this[o]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var o=this;function n(r,n){return i.type="throw",i.arg=t,o.next=r,n&&(o.method="next",o.arg=e),!!n}for(var s=this.tryEntries.length-1;s>=0;--s){var a=this.tryEntries[s],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var o=this.tryEntries.length-1;o>=0;--o){var n=this.tryEntries[o];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var s=n;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var a=s?s.completion:{};return a.type=t,a.arg=e,s?(this.method="next",this.next=s.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),U(o),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc===t){var r=o.completion;if("throw"===r.type){var n=r.arg;U(o)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(t,o,r){return this.delegate={iterator:S(t),resultName:o,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}}},e={};function o(r){var n=e[r];if(void 0!==n)return n.exports;var s=e[r]={exports:{}};return t[r](s,s.exports,o),s.exports}o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},o.d=(t,e)=>{for(var r in e)o.o(e,r)&&!o.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};(()=>{"use strict";o.r(r);const t=flarum.core.compat["forum/app"];var e=o.n(t);const n=flarum.core.compat["common/extend"],s=flarum.core.compat["forum/components/NotificationGrid"];var a=o.n(s);const i=flarum.core.compat["common/Model"];var l=o.n(i);const u=flarum.core.compat["common/models/User"];var c=o.n(u);const f=flarum.core.compat["forum/utils/UserControls"];var p=o.n(f);const h=flarum.core.compat["common/components/Button"];var d=o.n(h);function w(t,e,o,r,n,s,a){try{var i=t[s](a),l=i.value}catch(t){return void o(t)}i.done?e(l):Promise.resolve(l).then(r,n)}function v(){return v=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(t[r]=o[r])}return t},v.apply(this,arguments)}function y(t,e){return y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},y(t,e)}function g(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,y(t,e)}var b=o(195),_=o.n(b);const x=flarum.core.compat["common/components/Modal"];var L=o.n(x);const F=flarum.core.compat["common/components/Select"];var P=o.n(F);const k=flarum.core.compat["common/app"];var U=o.n(k),O=function(t){return function(e){return U().translator.trans("ianm-follow-users.lib.follow_levels."+t,e)}},S=Object.freeze([{value:"unfollow",name:O("unfollow.name"),description:O("unfollow.description")},{value:"follow",name:O("follow.name"),description:O("follow.description")},{value:"lurk",name:O("lurk.name"),description:O("lurk.description")}]),j=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),n=0;n<o;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))||this).state={user:null,saving:!1,followState:void 0},e.className=function(){return"iam_follow_users-selectFollowLevelModal"},e}g(o,t);var r=o.prototype;return r.oninit=function(e){t.prototype.oninit.call(this,e),this.state.user=this.attrs.user,this.state.followState=this.state.user.followed()||"unfollow"},r.title=function(){var t;return this.trans("title",{username:m("em",null,null==(t=this.state.user)||null==t.username?void 0:t.username())})},r.content=function(){var t=this;if(!(this.state.user instanceof c()))return m("div",{class:"Modal-body"},m("p",null,this.trans("no_user_attr_provided_err"+(e().forum.attribute("debug")?"_debug":""))));var o=this.state.user,r=S.reduce((function(t,e){var o;return v({},t,((o={})[e.value]=e.name(),o))}),{}),n=S.find((function(e){return e.value===t.state.followState}));return m("div",{class:"Modal-body"},m("fieldset",null,m("legend",null,this.trans("description",{user:o})),m("div",{class:"selectFollowLevelModal-level"},m("label",{for:"selectFollowLevelModal-select"},this.trans("follow_select_label")),m(P(),{disabled:this.state.saving,id:"selectFollowLevelModal-select",onchange:this.onFollowLevelChange.bind(this),value:n.value,"aria-described-by":"selectFollowLevelModal-"+n.value+"-help",options:r}),m("p",{id:"selectFollowLevelModal-"+n.value+"-help"},n.description({user:o})))),m("fieldset",{class:"selectFollowLevelModal-actions"},m(d(),{disabled:this.state.saving,class:"Button",onclick:this.hide.bind(this)},this.trans("cancel_btn")),m(d(),{disabled:this.state.saving,class:"Button Button--primary",onclick:this.saveFollowLevel.bind(this),loading:this.state.saving},this.trans("save_btn"))))},r.onFollowLevelChange=function(){var t=this.$(".Select-input")[0];this.state.followState=t.value||"unfollow"},r.trans=function(t){for(var o,r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];return(o=e().translator).trans.apply(o,["ianm-follow-users.forum.modals.select_follow_level."+t].concat(n))},r.onsubmit=function(){this.saveFollowLevel()},r.saveFollowLevel=function(){var t,e=(t=_().mark((function t(){var e;return _().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e="unfollow"===this.state.followState?null:this.state.followState,this.state.saving=!0,this.state.user.attribute("following")!==e){t.next=5;break}return this.hide(),t.abrupt("return");case 5:return t.next=7,this.state.user.save({followUsers:e});case 7:t.sent,this.hide();case 9:case"end":return t.stop()}}),t,this)})),function(){var e=this,o=arguments;return new Promise((function(r,n){var s=t.apply(e,o);function a(t){w(s,r,n,a,i,"next",t)}function i(t){w(s,r,n,a,i,"throw",t)}a(void 0)}))});return function(){return e.apply(this,arguments)}}(),o}(L());const E=flarum.core.compat["common/components/LinkButton"];var N=o.n(E);const B=flarum.core.compat["forum/components/UserPage"];var G=o.n(B);const M=flarum.core.compat["common/components/Link"];var T=o.n(M);const C=flarum.core.compat["common/helpers/avatar"];var D=o.n(C);const I=flarum.core.compat["common/helpers/username"];var z=o.n(I),A=function(t){function o(){return t.apply(this,arguments)||this}g(o,t);var r=o.prototype;return r.oninit=function(e){t.prototype.oninit.call(this,e),this.refresh()},r.refresh=function(){this.loading=!0,this.followedUsers=e().session.user.followedUsers(),this.loadUser(e().session.user.username())},r.changeUserFollowOptions=function(t){e().modal.show(j,{user:t})},r.content=function(){var t=this;return 0===this.followedUsers.length?m("div",{class:"Placeholder"},m("p",null,e().translator.trans("ianm-follow-users.forum.profile_page.no_following"))):m("table",{className:"NotificationGrid followPage-grid"},this.followedUsers.map((function(o,r){return m("tr",{class:"followPage-user"},m("td",null,m(T(),{href:e().route.user(o)},m("h3",null,D()(o,{className:"followPage-avatar"}),m("div",{class:"followPage-userInfo"},z()(o),m("span",{class:"followPage-type"},e().translator.trans("ianm-follow-users.forum.badge.label."+o.followed())))))),m("td",{className:"followPage-button"},m(d(),{icon:"fas fa-user-friends",type:"button",className:"Button Button--warning",onclick:function(){return t.changeUserFollowOptions(o)}},e().translator.trans("ianm-follow-users.forum.user_controls.unfollow_button"))))})))},r.show=function(){this.user=e().session.user,m.redraw()},o}(G());const R=flarum.core.compat["common/components/Notification"];var Y=o.n(R),q=function(t){function o(){return t.apply(this,arguments)||this}g(o,t);var r=o.prototype;return r.icon=function(){return"fas fa-user-friends"},r.href=function(){var t=this.attrs.notification.subject();return e().route.discussion(t)},r.content=function(){return e().translator.trans("ianm-follow-users.forum.notifications.new_discussion_text",{user:this.attrs.notification.fromUser(),title:this.attrs.notification.subject().title()})},r.excerpt=function(){return null},o}(Y()),$=function(t){function o(){return t.apply(this,arguments)||this}g(o,t);var r=o.prototype;return r.icon=function(){return"fas fa-user-friends"},r.href=function(){var t=this.attrs.notification,o=t.subject(),r=t.content()||{};return e().route.discussion(o,r.postNumber)},r.content=function(){return e().translator.trans("ianm-follow-users.forum.notifications.new_post_text",{user:this.attrs.notification.fromUser()})},r.excerpt=function(){return null},o}(Y()),H=function(t){function o(){return t.apply(this,arguments)||this}g(o,t);var r=o.prototype;return r.icon=function(){return"fas fa-user-plus"},r.href=function(){var t=this.attrs.notification.subject();return e().route.user(t)},r.content=function(){return e().translator.trans("ianm-follow-users.forum.notifications.new_follower_text",{user:this.attrs.notification.fromUser()})},r.excerpt=function(){return null},o}(Y()),J=function(t){function o(){return t.apply(this,arguments)||this}g(o,t);var r=o.prototype;return r.icon=function(){return"fas fa-user-minus"},r.href=function(){var t=this.attrs.notification.subject();return e().route.user(t)},r.content=function(){return e().translator.trans("ianm-follow-users.forum.notifications.new_unfollower_text",{user:this.attrs.notification.fromUser()})},r.excerpt=function(){return null},o}(Y());const K=flarum.core.compat["common/models/Discussion"];var Q=o.n(K);const V=flarum.core.compat["common/components/Badge"];var W=o.n(V);const X=flarum.core.compat["forum/components/SettingsPage"];var Z=o.n(X);const tt=flarum.core.compat["common/components/Switch"];var et=o.n(tt);const ot=flarum.extensions["fof-follow-tags"],rt=flarum.extensions["fof-user-directory"],nt=flarum.core.compat["forum/states/DiscussionListState"];var st=o.n(nt),at=ot.utils.followingPageOptions;const it=function(t){var e=at(t);return e.users=U().translator.trans("ianm-follow-users.lib.following_link"),e},lt=flarum.core.compat["common/components/Separator"];var ut=o.n(lt);e().initializers.add("ianm-follow-users",(function(){c().prototype.followed=l().attribute("followed"),c().prototype.followedUsers=l().hasMany("followedUsers"),c().prototype.blocksFollow=l().attribute("blocksFollow"),c().prototype.canBeFollowed=l().attribute("canBeFollowed"),e().routes.followedUsers={path:"/followedUsers",component:A},(0,n.extend)(p(),"userControls",(function(t,o){e().session.user&&e().session.user!==o&&t.add("follow",m(d(),{icon:"fas fa-user-friends",onclick:function(t){t instanceof c()&&e().modal.show(j,{user:t})}.bind(this,o)},e().translator.trans("ianm-follow-users.forum.user_controls."+(o.followed()?"unfollow_button":"follow_button"))))})),(0,n.extend)(G().prototype,"navItems",(function(t){e().session.user&&e().session.user===this.user&&t.add("followed-users",m(N(),{href:e().route("followedUsers"),icon:"fas fa-user-friends"},e().translator.trans("ianm-follow-users.forum.profile_link")))})),(0,n.extend)(Q().prototype,"badges",(function(t){var o;null!=(o=this.user())&&null!=o.followed&&o.followed()&&t.add("user-following",m(W(),{label:e().translator.trans("ianm-follow-users.forum.badge.label."+this.user().followed()),icon:"fas fa-user-friends",type:"friend"}))})),(0,n.extend)(c().prototype,"badges",(function(t){this.followed()&&t.add("user-following",m(W(),{label:e().translator.trans("ianm-follow-users.forum.badge.label."+this.followed()),icon:"fas fa-user-friends",type:"friend"}))})),(0,n.extend)(Z().prototype,"privacyItems",(function(t){var o=this;t.add("follow-users-block",m(et(),{state:this.user.preferences().blocksFollow,onchange:function(t){o.blocksFollowLoading=!0,o.user.savePreferences({blocksFollow:t}).then((function(){o.blocksFollowLoading=!1,m.redraw()}))},loading:this.blocksFollowLoading},e().translator.trans("ianm-follow-users.forum.settings.block_follow")))})),app.initializers.has("fof/follow-tags")&&(ot.utils.followingPageOptions=it,ot.utils.followingPageOptions("forum.index.following"),(0,n.extend)(st().prototype,"requestParams",(function(t){if(ot.utils.isFollowingPage()&&app.session.user){this.followTags||(this.followTags=ot.utils.getDefaultFollowingFiltering());var e=this.followTags;"following"===app.current.get("routeName")&&"users"===e&&(t.filter["following-users"]=!0,delete t.filter.subscription)}}))),app.initializers.has("fof-user-directory")&&(0,n.extend)(rt.UserDirectoryPage.prototype,"groupItems",(function(t){var e=this;t.add("follow-users",rt.CheckableButton.component({className:"GroupFilterButton",icon:"fas fa-user-friends",checked:"is:followeduser"===this.enabledSpecialGroupFilters["ianm-follow-users"],onclick:function(){var t="ianm-follow-users";"is:followeduser"===e.enabledSpecialGroupFilters[t]?e.enabledSpecialGroupFilters[t]="":e.enabledSpecialGroupFilters[t]="is:followeduser",e.changeParams(e.params().sort)}},app.translator.trans("ianm-follow-users.forum.filter.following")),65),t.add("separator",m(ut(),null),50)})),e().notificationComponents.newFollower=H,e().notificationComponents.newUnfollower=J,e().notificationComponents.newDiscussionByUser=q,e().notificationComponents.newPostByUser=$,(0,n.extend)(a().prototype,"notificationTypes",(function(t){t.add("newFollower",{name:"newFollower",icon:"fas fa-user-plus",label:e().translator.trans("ianm-follow-users.forum.settings.notify_new_follower_label")}),t.add("newUnfollower",{name:"newUnfollower",icon:"fas fa-user-minus",label:e().translator.trans("ianm-follow-users.forum.settings.notify_new_unfollower_label")}),t.add("newDiscussionByUser",{name:"newDiscussionByUser",icon:"fas fa-user-friends",label:e().translator.trans("ianm-follow-users.forum.settings.notify_new_discussion_label")}),t.add("newPostByUser",{name:"newPostByUser",icon:"fas fa-user-friends",label:e().translator.trans("ianm-follow-users.forum.settings.notify_new_post_label")})}))}),-1)})(),module.exports=r})();
//# sourceMappingURL=forum.js.map